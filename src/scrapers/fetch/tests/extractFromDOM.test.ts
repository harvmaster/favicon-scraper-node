import { expect, test } from "bun:test";
import extractFromDOM from "../extractFromDOM"

// DOM from https://ai.chat.mc.hzuccon.com
const DOM = `
<html dir="ltr" lang="en-US"><head><title>AI Chat</title><meta charset="utf-8"><meta name="description" content="An open-source chat interface for interacting with Ollama and OpenAI Models"><meta name="format-detection" content="telephone=no"><meta name="msapplication-tap-highlight" content="no"><meta name="viewport" content="user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1,width=device-width"><meta name="theme-color" content="#141414"><link rel="icon" type="image/png" sizes="128x128" href="icons/favicon-128x128.png"><link rel="icon" type="image/png" sizes="96x96" href="icons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png"><link rel="icon" type="image/ico" href="favicon.ico"><link rel="apple-touch-startup-image" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3)" href="icons/apple-launch-1290x2796.png"><link rel="apple-touch-startup-image" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3)" href="icons/apple-launch-1179x2556.png"><link rel="apple-touch-startup-image" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3)" href="icons/apple-launch-1284x2778.png"><link rel="apple-touch-startup-image" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3)" href="icons/apple-launch-1170x2532.png"><link rel="apple-touch-startup-image" media="(device-width: 360px) and (device-height: 780px) and (-webkit-device-pixel-ratio: 3)" href="icons/apple-launch-1080x2340.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2)" href="icons/apple-launch-828x1792.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3)" href="icons/apple-launch-1125x2436.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3)" href="icons/apple-launch-1242x2688.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)" href="icons/apple-launch-750x1334.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3)" href="icons/apple-launch-1242x2208.png"><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2)" href="icons/apple-launch-1620x2160.png"><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2)" href="icons/apple-launch-1536x2048.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2)" href="icons/apple-launch-1668x2224.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2)" href="icons/apple-launch-1668x2388.png"><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2)" href="icons/apple-launch-2048x2732.png">  <script type="module" crossorigin="" src="assets/index.d484b050.js"></script>
  <link rel="stylesheet" href="assets/index.69bcad9d.css">
<link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#027be3"><link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#027be3"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png"><meta name="msapplication-TileColor" content="#000000"><meta name="apple-mobile-web-app-title" content="AI Chat"><link rel="apple-touch-icon" href="/icons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="167x167" href="/icons/apple-icon-167x167.png"><link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-icon-180x180.png"><link rel="modulepreload" as="script" crossorigin="" href="assets/MainLayout.8fffae95.js"><link rel="stylesheet" href="assets/MainLayout.e6ae49dc.css"><link rel="modulepreload" as="script" crossorigin="" href="assets/useCurrentConversation.66c9a952.js"><link rel="modulepreload" as="script" crossorigin="" href="assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" as="script" crossorigin="" href="assets/IndexPage.67e366e6.js"><link rel="stylesheet" href="assets/IndexPage.93a118c7.css"></head><body class="desktop no-touch body--light"><div id="q-app" data-v-app=""><div data-v-5890a627="" class="q-layout q-layout--standard page-background" tabindex="-1" style="min-height: 811px;"><!----><!----><header data-v-5890a627="" class="q-header q-layout__section--marginal fixed-top row justify-center bg-transparent q-px-md" style="left: 300px;"><div data-v-5890a627="" class="col-auto visible-on-small self-center"><button data-v-5890a627="" class="q-btn q-btn-item non-selectable no-outline q-btn--flat q-btn--round text-white q-btn--actionable q-focusable q-hoverable q-btn--dense" tabindex="0" type="button"><span class="q-focus-helper"></span><span class="q-btn__content text-center col items-center q-anchor--skip justify-center row"><i class="q-icon notranslate material-icons" aria-hidden="true" role="img">menu</i></span></button></div><div data-v-5890a627="" class="col col-md-12 header-background text-h3 text-weight-bold q-pa-md row justify-center"><div data-v-5890a627="" class="rainbow-text col-auto"> AI Chat </div></div><!----></header><div data-v-5890a627="" class="q-drawer-container"><aside class="q-drawer q-drawer--left q-drawer--standard fixed q-drawer--top-padding" style="width: 300px; transform: translateX(0px);"><div class="q-drawer__content fit scroll bg-secondary text-white column"><div data-v-5890a627="" class="drawer-list q-pa-sm col ac-scrollbar"><div data-v-5890a627="" class="drawer-item row" clickable=""><div data-v-5890a627="" class="col-auto text-weight-bolder q-pl-md q-pr-lg rainbow-text"> AI </div><div data-v-5890a627="" class="drawer-item-text col self-center"><div data-v-5890a627="" class="text-weight-bold">New Chat</div></div><div data-v-5890a627="" class="drawer-item-icon col-auto q-px-md"><i data-v-5890a627="" class="q-icon notranslate material-icons" aria-hidden="true" role="presentation">library_add</i></div></div><hr data-v-5890a627="" class="q-separator q-separator--horizontal bg-white" aria-orientation="horizontal"></div><div data-v-5890a627="" class="github-link q-pa-sm bg-secondary col-auto"><a data-v-5890a627="" class="q-btn q-btn-item non-selectable no-outline q-btn--flat q-btn--round q-btn--actionable q-focusable q-hoverable" tabindex="0" href="https://github.com/harvmaster/AiChat" target="_blank"><span class="q-focus-helper"></span><span class="q-btn__content text-center col items-center q-anchor--skip justify-center row"><i class="q-icon" aria-hidden="true" role="img"><img src="/github-white.svg"></i></span></a></div></div></aside></div><div data-v-5890a627="" class="q-page-container" style="padding-top: 82px; padding-left: 300px;"><main data-v-127602e4="" data-v-5890a627="" class="q-page row items-stretch q-pa-md justify-center" style="min-height: 729px;"><div data-v-127602e4="" class="col-12 col-md-8 col-lg-6 column"><div data-v-127602e4="" class="col relative full-width"><!----></div><div data-v-127602e4="" class="col-auto row q-pa-md row justify-center"><div data-v-127602e4="" class="col-12 bg-primary q-pa-md rounded-borders input-border row col-12"><!----><div class="col text-h6 self-center q-pl-md row"><textarea id="chat-input" type="textarea" class="my-input full-width text-white self-center" placeholder="Send a message" rows="1">
      </textarea></div><div class="col-auto self-center q-px-sm"><button class="q-btn q-btn-item non-selectable no-outline q-btn--flat q-btn--round text-accent q-btn--actionable q-focusable q-hoverable q-btn--dense" tabindex="0" type="button"><span class="q-focus-helper"></span><span class="q-btn__content text-center col items-center q-anchor--skip justify-center row"><i class="q-icon notranslate material-icons" aria-hidden="true" role="img">attach_file</i></span></button></div><div class="col-auto self-center"><button class="q-btn q-btn-item non-selectable no-outline q-btn--flat q-btn--round text-accent q-btn--actionable q-focusable q-hoverable q-btn--dense" tabindex="0" type="button"><span class="q-focus-helper"></span><span class="q-btn__content text-center col items-center q-anchor--skip justify-center row"><i class="q-icon notranslate material-icons" aria-hidden="true" role="img">send</i></span></button></div></div><div data-v-127602e4="" class="col-auto row q-pt-md justify-center"><div data-v-127602e4="" class="row pill model-settings-button cursor-pointer q-pa-sm"><div data-v-127602e4="" class="col-auto text-blue-2 text-h6 text-center">AI Chat (phi3) </div><div data-v-127602e4="" class="col-auto text-blue-2 text-h6 q-px-sm"><i data-v-127602e4="" class="q-icon notranslate material-icons" aria-hidden="true" role="presentation">keyboard_arrow_up</i></div></div></div></div></div><!----></main></div></div></div><div id="q-notify" data-v-app=""><div class="q-notifications"><div class="q-notifications__list q-notifications__list--top fixed column no-wrap items-start"></div><div class="q-notifications__list q-notifications__list--top fixed column no-wrap items-end"></div><div class="q-notifications__list q-notifications__list--bottom fixed column no-wrap items-start"></div><div class="q-notifications__list q-notifications__list--bottom fixed column no-wrap items-end"></div><div class="q-notifications__list q-notifications__list--top fixed column no-wrap items-center"></div><div class="q-notifications__list q-notifications__list--bottom fixed column no-wrap items-center"></div><div class="q-notifications__list q-notifications__list--center fixed column no-wrap items-start justify-center"></div><div class="q-notifications__list q-notifications__list--center fixed column no-wrap items-end justify-center"></div><div class="q-notifications__list q-notifications__list--center fixed column no-wrap flex-center"></div></div></div></body></html>
`

test('extractFromDOM', () => {
  const icons = extractFromDOM(DOM)
  expect(icons).toContainAllValues([
    "icons/favicon-128x128.png",
    "icons/favicon-96x96.png",
    "icons/favicon-32x32.png",
    "icons/favicon-16x16.png",
    "favicon.ico",
    "/icons/safari-pinned-tab.svg",
    "/icons/apple-icon-120x120.png",
    "/icons/apple-icon-152x152.png",
    "/icons/apple-icon-167x167.png",
    "/icons/apple-icon-180x180.png",
    "favicon.ico"
  ])
})